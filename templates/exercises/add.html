{% extends 'base.html' %}

{% block title %}Tambah Latihan Baru{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Tambah Latihan Baru</h2>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('exercises.add') }}">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        
                        <div class="mb-3">
                            <label for="name" class="form-label">Nama Latihan <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="category" class="form-label">Kategori</label>
                            <select class="form-select" id="category" name="category">
                                <option value="">-- Pilih Kategori --</option>
                                <option value="Chest">Chest (Dada)</option>
                                <option value="Back">Back (Punggung)</option>
                                <option value="Legs">Legs (Kaki)</option>
                                <option value="Shoulders">Shoulders (Bahu)</option>
                                <option value="Arms">Arms (Lengan)</option>
                                <option value="Core">Core (Inti)</option>
                                <option value="Cardio">Cardio</option>
                                <option value="Full Body">Full Body</option>
                                <option value="Other">Lainnya</option>
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label for="description" class="form-label">Deskripsi</label>
                            <textarea class="form-control" id="description" name="description" rows="4"></textarea>
                        </div>
                        
                        <!-- Opsi Weight -->
                        <div class="mb-3">
                            <label class="form-label">Opsi Satuan Weight</label>
                            <div class="card">
                                <div class="card-body">
                                    <div id="weight-options">
                                        <div class="weight-option mb-3">
                                            <div class="row">
                                                <div class="col-md-10">
                                                    <input type="text" class="form-control" name="weight_units[]" placeholder="Satuan (contoh: kg, lb, detik)">
                                                </div>
                                                <div class="col-md-2 d-flex align-items-stretch">
                                                    <button type="button" class="btn btn-outline-danger remove-weight h-100" style="display:none;"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-sm btn-success" id="add-weight-option">
                                        <i class="bi bi-plus-lg me-1"></i> Tambah Satuan Weight
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Opsi Reps -->
                        <div class="mb-3">
                            <label class="form-label">Opsi Satuan Reps</label>
                            <div class="card">
                                <div class="card-body">
                                    <div id="reps-options">
                                        <div class="reps-option mb-3">
                                            <div class="row">
                                                <div class="col-md-10">
                                                    <input type="text" class="form-control" name="reps_units[]" placeholder="Satuan (contoh: kali, detik)">
                                                </div>
                                                <div class="col-md-2 d-flex align-items-stretch">
                                                    <button type="button" class="btn btn-outline-danger remove-reps h-100" style="display:none;"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-sm btn-success" id="add-reps-option">
                                        <i class="bi bi-plus-lg me-1"></i> Tambah Satuan Reps
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-between">
                            <a href="{{ url_for('exercises.index') }}" class="btn btn-secondary">Kembali</a>
                            <button type="submit" class="btn btn-primary">Simpan</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Weight options
        const weightOptionsContainer = document.getElementById('weight-options');
        const addWeightBtn = document.getElementById('add-weight-option');
        
        addWeightBtn.addEventListener('click', function() {
            const weightOption = document.createElement('div');
            weightOption.className = 'weight-option mb-3';
            weightOption.innerHTML = `
                <div class="row">
                    <div class="col-md-10">
                        <input type="text" class="form-control" name="weight_units[]" placeholder="Satuan (contoh: kg, lb, detik)">
                    </div>
                    <div class="col-md-2 d-flex align-items-stretch">
                        <button type="button" class="btn btn-outline-danger remove-weight h-100" style="display:none;"><i class="bi bi-trash"></i></button>
                    </div>
                </div>
            `;
            weightOptionsContainer.appendChild(weightOption);
            
            // Show all remove buttons when there's more than one option
            const removeButtons = document.querySelectorAll('.remove-weight');
            if (removeButtons.length > 1) {
                removeButtons.forEach(btn => btn.style.display = 'block');
            }
        });
        
        // Event delegation for remove buttons
        weightOptionsContainer.addEventListener('click', function(e) {
            if (e.target.classList.contains('remove-weight') || e.target.closest('.remove-weight')) {
                const weightOption = e.target.closest('.weight-option');
                weightOption.remove();
                
                // Hide remove button if only one option left
                const removeButtons = document.querySelectorAll('.remove-weight');
                if (removeButtons.length <= 1) {
                    removeButtons.forEach(btn => btn.style.display = 'none');
                }
            }
        });
        
        // Reps options
        const repsOptionsContainer = document.getElementById('reps-options');
        const addRepsBtn = document.getElementById('add-reps-option');
        
        addRepsBtn.addEventListener('click', function() {
            const repsOption = document.createElement('div');
            repsOption.className = 'reps-option mb-3';
            repsOption.innerHTML = `
                <div class="row">
                    <div class="col-md-10">
                        <input type="text" class="form-control" name="reps_units[]" placeholder="Satuan (contoh: kali, detik)">
                    </div>
                    <div class="col-md-2 d-flex align-items-stretch">
                        <button type="button" class="btn btn-outline-danger remove-reps h-100" style="display:none;"><i class="bi bi-trash"></i></button>
                    </div>
                </div>
            `;
            repsOptionsContainer.appendChild(repsOption);
            
            // Show all remove buttons when there's more than one option
            const removeButtons = document.querySelectorAll('.remove-reps');
            if (removeButtons.length > 1) {
                removeButtons.forEach(btn => btn.style.display = 'block');
            }
        });
        
        // Event delegation for remove buttons
        repsOptionsContainer.addEventListener('click', function(e) {
            if (e.target.classList.contains('remove-reps') || e.target.closest('.remove-reps')) {
                const repsOption = e.target.closest('.reps-option');
                repsOption.remove();
                
                // Hide remove button if only one option left
                const removeButtons = document.querySelectorAll('.remove-reps');
                if (removeButtons.length <= 1) {
                    removeButtons.forEach(btn => btn.style.display = 'none');
                }
            }
        });
    });
</script>
{% endblock %}
{% endblock %}